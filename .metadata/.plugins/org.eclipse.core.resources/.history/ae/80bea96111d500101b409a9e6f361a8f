package ejercicios;

import java.util.ArrayList;
import java.util.HashSet;
import java.util.List;
import java.util.Scanner;
import java.util.Set;


public class mini2048 {
    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);
    int casos = sc.nextInt();
    for (int t = 0; t < casos; t++) {
    	int tamaño = sc.nextInt();
    			List<Integer> numeros = new ArrayList<>();
		for (int i = 0; i < tamaño; i++) {
			numeros.add(sc.nextInt());
		}
	// desplazamos y juntamos sin son iguales	
	String LorR = sc.next();
			if (LorR.equals("L")) {
			
				
			}
			else if (LorR.equals("R")) {
				List<Integer> rev = new ArrayList<>();
                for (int i = tamaño - 1; i >= 0; i--) {
                    int v = nums.get(i);
                    if (v != 0) rev.add(v);
                }
                while (rev.size() < tamaño) rev.add(0);

                Set<Integer> merged = new HashSet<>();
                for (int i = 0; i < tamaño - 1; i++) {
                    int cur = rev.get(i);
                    int nxt = rev.get(i + 1);
                    if (cur != 0 && cur == nxt && !merged.contains(i) && !merged.contains(i + 1)) {
                        rev.set(i, cur * 2);
                        rev.set(i + 1, 0);
                        merged.add(i);
                    }
			}}
			else {
				System.out.println("Error");
			}
    }
        sc.close();
    }
}